source = ~/.config/hypr/mocha.conf

# env setup
env = HYPRLAND_LOG_WLR, 1
#env = GBM_BACKEND, nvidia-drm
env = EGL_PLATFORM, wayland
#env = WLR_NO_HARDWARE_CURSORS, 1
env = __GL_GSYNC_ALLOWED, 1
env = __GL_VRR_ALLOWED, 1
#env = LIBVA_DRIVER_NAME, iHD
#env = NVD_BACKEND, direct
#env = MOZ_DRM_DEVICE, /dev/dri/renderD129
env = MOZ_ENABLE_WAYLAND, 1
env = MOZ_DISABLE_RDD_SANDBOX, 1
env = THEME_DIR, /usr/share/themes/Catppuccin-Mocha-Standard-Lavender-Dark
env = GTK_THEME, Catppuccin-Mocha-Standard-Sapphire-Dark
env = GTK_USE_PORTAL=1 
env = STEAM_FORCE_DESKTOPUI_SCALING, 1.25
#env = DXVK_FRAME_RATE, 120
env = XCURSOR_THEME, Catppuccin-Mocha-Sapphire-Cursors
env = XCURSOR_SIZE, 16
#env = QT_QPA_PLATFORM, wayland;xcb
env = QT_WAYLAND_DISABLE_WINDOWDECORATION, 1
env = QT_QPA_PLATFORMTHEME, qt5ct
#env = GDK_BACKEND, wayland, x11
#env = XDG_CURRENT_DESKTOP, Hyprland
env = XDG_SESSION_TYPE, wayland
#env = XDG_SESSION_DESKTOP, Hyprland
env = WLR_DRM_NO_ATOMIC, 1


exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = hyprpaper
exec-once = openrgb --server --noautoconnect
exec-once = spotify --disable-lcd-text --ozone-platform-hint=auto
exec-once = firefox
exec-once = signal --disable-lcd-text --ozone-platform-hint=auto
exec-once = teams-for-linux
exec-once = hyprpaper
exec-once = flameshot
exec-once = /usr/lib/kdeconnectd
exec-once = /home/lap/.cache/pypoetry/virtualenvs/normcap-ff0zFrDv-py3.11/bin/python /home/lap/.local/git/normcap/normcap/__main__.py
exec-once = /usr/lib/polkit-kde-authentication-agent-1

# clipboard
exec-once = wl-paste -t text --watch clipman store
exec-once = wl-paste -p -t text --watch clipman  store -P --histpath = "~/.local/share/clipman-primary.json"
exec-once = ~/.config/hypr/clipboard.sh

exec-once = /usr/lib/polkit-kde-authentication-agent-1

# idle timeout
# exec-once = swayidle -w timeout 600 "swaylock" before-sleep "swaylock"           # lock screen after 10 min of idle
exec-once = swayidle -w timeout 600 "systemctl suspend-then-hibernate"             # sleep after 10 mins of idle

# autostarts with hot reloads
## gBar
exec-once = ls ~/.config/gBar/style.scss | entr -pns "sass ~/.config/gBar/style.scss > ~/.config/gBar/style.css"
### while true restarts the process in case the file gets deleted
# exec-once = while true; do ls ~/.config/gBar/style.css ~/.config/gBar/config | entr -nrs "gBar bar 0"; sleep 1; done
exec-once = ls ~/.config/gBar/style.css ~/.config/gBar/config | entr -pnrs "systemctl --user restart gBar"

## dunst
exec-once = ls ~/.config/dunst/dunstrc | entr -nrs "dunst"

## pypr
exec-once = ls ~/.config/hypr/pyprland.toml | entr -nrs "rm /tmp/hypr/*/.pyprland.sock -f; pypr"

# monitor = DP-2, disable
monitor = HDMI-A-1, 3840x2160@120, 0x0, 1
monitor = HDMI-A-1, addreserved, -6, 0, 0, 0
 
input {
    kb_model = pc105awide
    kb_layout = us
    kb_variant = cmk_ed_us
    kb_options = misc:extend, lv5:caps_switch_lock, grp:shifts_toggle, compose:menu, misc:cmk_curl_dh 
    
    repeat_rate = 40
    repeat_delay = 200

    kb_file =
    kb_rules = evdev

    follow_mouse = 1

    touchpad {
        natural_scroll = yes
        disable_while_typing = no
        clickfinger_behavior = yes
    }

    sensitivity = 0.0 # -1.0 - 1.0, 0 means no modification.
}

general {
    gaps_in = 5
    gaps_out = 20
    border_size = 2
    col.active_border = rgba(8822bbff) rgba(2222bbff) 30deg
    col.inactive_border = rgba(333333ff)
    cursor_inactive_timeout = 1

    allow_tearing = true
    apply_sens_to_raw = 0 # whether to apply the sensitivity to raw input (e.g. used by games where you aim using your mouse)

    # damage_tracking = full # leave it on full unless you hate your GPU and want to make it suffer
}

xwayland {
  force_zero_scaling = true
}

decoration {
    rounding = 10
    blur {
        size = 3 # minimum 1
        passes = 2 # minimum 1
        new_optimizations = 1
        brightness = 0.7
        contrast = 1
        # vibrancy = 0.5
    }
    col.shadow = 0xbb1a0a1a
    col.shadow_inactive = 0x881a1a1a
    shadow_range = 20
    shadow_render_power = 2
    dim_inactive = true
    dim_strength = 0.1
    #inactive_opacity = 0.9
    dim_special = 0.2
}

bezier=slow,0,0.85,0.3,1
bezier=overshot,0.7,0.6,0.1,1.1
bezier=bounce,1,1.6,0.1,0.85
bezier=slingshot,1,-2,0.9,1.25
bezier=nice,0,6.9,0.5,-4.20

animations {
    enabled=1
    #animation=windows,1,5,bounce,slide
    animation=windows,1,5,overshot,slide
    animation=border,1,20,default
    animation=fade,1,5,default
    animation=workspaces,1,5,overshot,slide
}

dwindle {
    pseudotile = 0 # enable ps
    pseudotile=0 # enable pseudotiling on dwindle
    split_width_multiplier=1.25
}

gestures {
    workspace_swipe = true
    workspace_swipe_forever = true
    workspace_swipe_min_speed_to_force = 5
    workspace_swipe_distance = 200
    workspace_swipe_direction_lock = false
}

xwayland { 
    force_zero_scaling = true
}

misc {
    disable_splash_rendering = true
    no_direct_scanout = false
    animate_manual_resizes = true
    enable_swallow = true
    swallow_regex = ^(Alacritty|kitty|footclient)$
}

binds {
  # pass_mouse_when_bound = false
}

# example window rules
# for windows named/classed as abc and xyz
#windowrule = move 69 420, abc
#windowrule = size 420 69, abc
#windowrule = tile, xyz
#windowrule = float, abc
#windowrule = pseudo, abc
windowrulev2 = workspace 1, class:^(firefox)$
windowrulev2 = workspace 2, class:^(jetbrains-client)$
windowrulev2 = workspace 3, class:^(.*Godot Engine)$
windowrulev2 = workspace 4, class:^(teams-for-linux)$
windowrulev2 = workspace 4, class:^(Spotify)$
windowrulev2 = workspace 5, class:^(Signal)$
windowrulev2 = workspace 8, class:^(openrgb)$
windowrulev2 = workspace 9, class:^(jetbrains-gateway)$
#windowrulev2 = opaque, class:^(kitty)$
#windowrulev2 = opacity 0.6 0.6, class:^(kitty)$
#set flameshot to floating
windowrulev2 = float,class:^(flameshot)$,title:^(flameshot)
# xwayland fixes
# rider issues
windowrulev2 = nofocus, class:^(jetbrains-rider)$, title:^(win*.)$
windowrulev2 = bordercolor rgb(EE4B2B), class:^(jetbrains-rider)$, title:^(win*.)$
# unity issues
#windowrulev2 = opacity 0.8 0.8, class:^(Unity)$
windowrulev2 = opaque, class:^(Unity)$
windowrulev2 = move cursor -50% -50%, class:^(Unity)$, title:^(Color)$
windowrulev2 = move cursor -50% -50%, class:^(Unity)$, title:^(Select Texture)$
windowrulev2 = move cursor -50% -50%, class:^(Unity)$, title:^(UnityEditor.Searcher.SearcherWindow)$
windowrulev2 = move cursor -50% -50%, class:^(Unity)$, title:^(UnityEditor.AddComponent.AddComponentWindow)$
windowrulev2 = move cursor -50% -50%, class:^(Unity)$, title:^(Select Sprite)$
#windowrulev2 = immediate, class:^(rocketleague)$
#windowrulev2 = bordercolor rgb(EE4B2B), class:^(Unity)$ #, tit# -- Fix odd behaviors in IntelliJ IDEs --


#! Fix focus issues when dialogs are opened or closed
windowrulev2 = windowdance,class:^(jetbrains-.*)$,floating:1
#! Fix splash screen showing in weird places and prevent annoying focus takeovers
windowrulev2 = center,class:^(jetbrains-.*)$,title:^(splash)$,floating:1
windowrulev2 = nofocus,class:^(jetbrains-.*)$,title:^(splash)$,floating:1
windowrulev2 = noborder,class:^(jetbrains-.*)$,title:^(splash)$,floating:1

#! Center popups/find windows
windowrulev2 = center,class:^(jetbrains-.*)$,title:^( )$,floating:1
windowrulev2 = stayfocused,class:^(jetbrains-.*)$,title:^( )$,floating:1
windowrulev2 = noborder,class:^(jetbrains-.*)$,title:^( )$,floating:1
#! Disable window flicker when autocomplete or tooltips appear
windowrulev2 = nofocus,class:^(jetbrains-.*)$,title:^(win.*)$,floating:1le:^(win*.)$


windowrulev2 = immediate, class:^(steam_app_1966720)$


# windowrulev2 = nofullscreenrequest, class:^(firefox-work)$
# windowrulev2 = nomaximizerequest, class:^(firefox-work)$

# gBar blur
layerrule = blur, ^(gtk-layer-shell)$
layerrule = ignorezero, ^(gtk-layer-shell)$

# dunst blur
layerrule = blur, ^(notifications)$
layerrule = ignorezero, ^(notifications)$

# rofi blur
layerrule = blur, ^(rofi)$
layerrule = ignorezero, ^(rofi)$

#windowrule = tile, jetbrains-client
windowrule = tile, jetbrains-gateway
windowrulev2 = tile, title:^(.*Godot Engine)$

# test with pinned scratch workspaces
# windowrulev2 = pin, class:^(kitty-dropterm)$

# some nice mouse binds
bindm = SUPER, mouse:272, movewindow
bindm = SUPER, mouse:273, resizewindow

bind = SUPER, Q, exec, kitty
bind = SUPER, C, killactive,
bind = SUPER, M, exit,
bind = SUPER, E, exec, dolphin
bind = ALT, F, togglefloating,
bind = SUPERSHIFT, F, fullscreen, 1
bind = SUPER, R, exec, rofi -show drun -theme $HOME/.config/rofi/launchers/type-3/style-1.rasi
#bind = SUPER, P, exec, grim -g "$(slurp)" - | wl-copy
bind = SUPER, P, exec, XDG_CURRENT_DESKTOP=Sway flameshot gui
bind = , PRINT, exec, hyprland-interactive-screenshot
#bind = SUPER, P, pseudo,

# will switch to a submap called resize
bind = MOD3SUPER, space, exec, dunstify "yeee boiii" "Activated super special layer" -t 0 -h string:x-dunst-stack-tag:layer -r 187
bind = MOD3SUPER, space, submap, resize

# will start a submap called "resize"
submap = resize

# sets repeatable binds for resizing the active window
binde = MOD3SUPER, n, resizeactive, -20 0
binde = MOD3SUPER, u, resizeactive, 0 -20
binde = MOD3SUPER, i, resizeactive, 20 0
binde = MOD3SUPER, e, resizeactive, 0 20
binde = MOD3SUPER, ie, resizeactive, 20 20

# sets repeatable binds to move the active window
binde = MOD3SUPERCTRL, n, moveactive, -20 0
binde = MOD3SUPERCTRL, i, moveactive, 20 0
binde = MOD3SUPERCTRL, u, moveactive, 0 -20
binde = MOD3SUPERCTRL, e, moveactive, 0 20

# use reset to go back to the global submap
bind = MOD3, Q, exec, dunstify -C 187 
bind = MOD3, Q, submap, reset 

# will reset the submap, meaning end the current one and return to the global one
submap = reset

# extend specific
bind = MOD3SUPER, n, movefocus, l
bind = MOD3SUPER, i, movefocus, r
bind = MOD3SUPER, u, movefocus, u
bind = MOD3SUPER, e, movefocus, d

bind = MOD3SUPERCTRL, l, workspace, 1
bind = MOD3SUPERCTRL, y, workspace, e+1
bind = MOD3SUPERCTRL, i, workspace, +1
bind = MOD3SUPERCTRL, n, workspace, -1

bind = MOD3SUPERCTRLSHIFT, l, movetoworkspace, 1
bind = MOD3SUPERCTRLSHIFt, y, movetoworkspace, e+1
bind = MOD3SUPERCTRLSHIFT, i, movetoworkspace, +1
bind = MOD3SUPERCTRLSHIFT, n, movetoworkspace, -1

# normal binds
bind = SUPER, left, movefocus, l
bind = SUPER, right, movefocus, r
bind = SUPER, up, movefocus, u
bind = SUPER, down, movefocus, d

bind = SUPER, 1, workspace, 1
bind = SUPER, 2, workspace, 2
bind = SUPER, 3, workspace, 3
bind = SUPER, 4, workspace, 4
bind = SUPER, 5, workspace, 5
bind = SUPER, 6, workspace, 6
bind = SUPER, 7, workspace, 7
bind = SUPER, 8, workspace, 8
bind = SUPER, 9, workspace, 9
bind = SUPER, 0, workspace, 10


bind = ALT, 1, movetoworkspace, 1
bind = ALT, 2, movetoworkspace, 2
bind = ALT, 3, movetoworkspace, 3
bind = ALT, 4, movetoworkspace, 4
bind = ALT, 5, movetoworkspace, 5
bind = ALT, 6, movetoworkspace, 6
bind = ALT, 7, movetoworkspace, 7
bind = ALT, 8, movetoworkspace, 8
bind = ALT, 9, movetoworkspace, 9
bind = ALT, 0, movetoworkspace, 10

bind = SUPER, mouse_down, workspace, e+1
bind = SUPER, mouse_up, workspace, e-1

bindl = , XF86AudioPlay, exec, playerctl -p spotify play-pause
bindl = , XF86AudioPause, exec, playerctl -p spotify pause
bindl = , XF86AudioStop, exec, playerctl -p spotify stop
bindl = , XF86AudioNext, exec, playerctl -p spotify next
bindl = , XF86AudioPrev, exec, playerctl -p spotify previous

bindl = SHIFT, XF86AudioPlay, exec, playerctl play-pause
bindl = SHIFT, XF86AudioPause, exec, playerctl pause
bindl = SHIFT, XF86AudioStop, exec, playerctl stop
bindl = SHIFT, XF86AudioNext, exec, playerctl next
bindl = SHIFT, XF86AudioPrev, exec, playerctl previous

bindl = , XF86MonBrightnessDown, exec, brightnessctl set 5%-
bindl = , XF86MonBrightnessUp, exec, brightnessctl set +5%


# pyprland things
bind = MOD3SUPER, L, exec, pypr toggle termleft
bind = MOD3SUPER, Y, exec, pypr toggle termright
bind = MOD3SUPER, H, exec, pypr toggle workinfo
bind = MOD3SUPER, O, exec, pypr toggle knowledge
bind = SUPER SHIFT, M, exec, pypr toggle stb stb-logs
bind = SUPER, A, exec, pypr toggle term
bind = SUPER, V, exec, pypr toggle volume

# pie
windowrule = noblur, kando
windowrule = noborder, kando
windowrule = noanim, kando
windowrule = center, kando
windowrule = size 100% 100%, kando
#bind = CTRL, Space, global, kando:prototype_trigger
